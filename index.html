<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Nola Birthday AR</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- A-Frame + MindAR (official docs versions) -->
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>

    <style>
      body, html {
        margin: 0;
        padding: 0;
        overflow: hidden;
        width: 100%;
        height: 100%;
        background: #000;
      }
      #ar-container {
        width: 100%;
        height: 100%;
        position: fixed;
        top: 0;
        left: 0;
      }
      #debug {
        position: absolute;
        z-index: 9999;
        left: 8px;
        bottom: 8px;
        color: #fff;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        font-size: 12px;
        background: rgba(0,0,0,0.4);
        padding: 4px 8px;
        border-radius: 4px;
      }
    </style>
  </head>
  <body>
    <div id="ar-container">
      <div id="debug">Page loaded â€“ waiting for ARâ€¦</div>

      <a-scene
        mindar-image="imageTargetSrc: ./assets/targets.mind; autoStart: true;"
        vr-mode-ui="enabled: false"
        device-orientation-permission-ui="enabled: false"
        embedded
      >
        <a-assets>
          <img id="card" src="./assets/card.png" />
          <img id="balloon" src="./assets/balloon.png" />
          <img id="star" src="./assets/star.png" />
          <img id="hbd" src="./assets/hbd.png" />
        </a-assets>

        <!-- Camera -->
        <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

        <!-- AR content -->
        <a-entity mindar-image-target="targetIndex: 0">

          <!-- Main card -->
          <a-plane
            src="#card"
            width="1.2"
            height="1.5"
            position="0 0 0"
            animation="property: scale; to: 1.05 1.05 1; dir: alternate; loop: true; dur: 1200; easing: easeInOutSine"
          ></a-plane>

          <!-- Happy Birthday text floating above -->
          <a-image
            src="#hbd"
            width="1"
            height="0.4"
            position="0 0.9 0.01"
            animation="property: position; to: 0 1.0 0.01; dir: alternate; loop: true; dur: 1500; easing: easeInOutSine"
          ></a-image>

          <!-- Left balloon bobbing -->
          <a-image
            src="#balloon"
            width="0.35"
            height="0.6"
            position="-0.8 0.4 0.02"
            animation="property: position; to: -0.8 0.7 0.02; dir: alternate; loop: true; dur: 1800; easing: easeInOutSine"
          ></a-image>

          <!-- Right balloon bobbing -->
          <a-image
            src="#balloon"
            width="0.35"
            height="0.6"
            position="0.8 0.4 0.02"
            animation="property: position; to: 0.8 0.7 0.02; dir: alternate; loop: true; dur: 1600; easing: easeInOutSine"
          ></a-image>

          <!-- Spinning stars -->
          <a-image
            src="#star"
            width="0.25"
            height="0.25"
            position="-0.4 1.3 0.02"
            animation="property: rotation; to: 0 0 360; loop: true; dur: 3000; easing: linear"
          ></a-image>

          <a-image
            src="#star"
            width="0.25"
            height="0.25"
            position="0.4 1.3 0.02"
            animation="property: rotation; to: 0 0 -360; loop: true; dur: 3000; easing: linear"
          ></a-image>
        </a-entity>
      </a-scene>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const debug = document.getElementById("debug");
        const scene = document.querySelector("a-scene");
        const target = document.querySelector("[mindar-image-target]");

        debug.textContent = "DOM ready â€“ initializing ARâ€¦";

        scene.addEventListener("arReady", () => {
          debug.textContent = "AR ready â€“ point camera at the card ðŸ˜Š";
        });

        scene.addEventListener("arError", (e) => {
          debug.textContent = "AR error: " + JSON.stringify(e.detail || {});
        });

        if (target) {
          target.addEventListener("targetFound", () => {
            debug.textContent = "Target FOUND ðŸŽ‰";
          });
          target.addEventListener("targetLost", () => {
            debug.textContent = "Target lost â€“ move camera closer.";
          });
        }
      });
    </script>
  </body>
</html>
